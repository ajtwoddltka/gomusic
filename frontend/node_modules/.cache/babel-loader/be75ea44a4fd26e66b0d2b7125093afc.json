{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\whktj\\\\Go_music\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\whktj\\\\Go_music\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:\\\\Users\\\\whktj\\\\Go_music\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\whktj\\\\Go_music\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:\\\\Users\\\\whktj\\\\Go_music\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\whktj\\\\Go_music\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\whktj\\\\Go_music\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';import{injectStripe,StripeProvider,Elements,CardElement}from'react-stripe-elements';var INITIALSTATE=\"INITIAL\",SUCCESSSTATE=\"COMPLETE\",FAILEDSTATE=\"FAILED\";var CreditCardForm=/*#__PURE__*/function(_React$Component){_inherits(CreditCardForm,_React$Component);var _super=_createSuper(CreditCardForm);function CreditCardForm(props){var _this;_classCallCheck(this,CreditCardForm);_this=_super.call(this,props);_this.handleSubmit=_this.handleSubmit.bind(_assertThisInitialized(_this));_this.handleInputChange=_this.handleInputChange.bind(_assertThisInitialized(_this));_this.state={value:'',status:INITIALSTATE};return _this;}_createClass(CreditCardForm,[{key:\"renderCreditCardInformation\",value:function renderCreditCardInformation(){var style={base:{'fontSize':'20px','color':'#495057','fontFamily':'apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,\"Helvetica Neue\",Arial,sans-serif'}};var usersavedcard=/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"form-row text-center\"},/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn  btn-outline-success text-center mx-auto\"},\"Use saved card?\")),/*#__PURE__*/React.createElement(\"hr\",null));var remembercardcheck=/*#__PURE__*/React.createElement(\"div\",{className:\"form-row form-check text-center\"},/*#__PURE__*/React.createElement(\"input\",{className:\"form-check-input\",type:\"checkbox\",value:\"\",id:\"remembercardcheck\"}),/*#__PURE__*/React.createElement(\"label\",{className:\"form-check-label\",htmlFor:\"remembercardcheck\"},\"Remember Card?\"));return/*#__PURE__*/React.createElement(\"div\",null,usersavedcard,/*#__PURE__*/React.createElement(\"h5\",{className:\"mb-4\"},\"Payment Info\"),/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.handleSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"form-row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-12 form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"cc-name\"},\"Name On Card:\"),/*#__PURE__*/React.createElement(\"input\",{id:\"cc-name\",name:\"cc-name\",className:\"form-control\",placeholder:\"Name on Card\",onChange:this.handleInputChange,type:\"text\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"form-row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-12 form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"card\"},\"Card Information:\"),/*#__PURE__*/React.createElement(CardElement,{id:\"card\",className:\"form-control\",style:style}))),remembercardcheck,/*#__PURE__*/React.createElement(\"hr\",{className:\"mb-4\"}),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-success btn-large\"},this.props.operation)));}},{key:\"renderSuccess\",value:function renderSuccess(){var _this2=this;return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h5\",{className:\"mb-4 text-success\"},\"Credit card payment processed.....\"),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-success btn-large\",onClick:function onClick(){_this2.props.toggle();}},\"Ok\"));}},{key:\"renderFailure\",value:function renderFailure(){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h5\",{className:\"mb-4 text-danger\"},\" Credit card information invalid, try again or exit\"),this.renderCreditCardInformation());}},{key:\"handleSubmit\",value:function(){var _handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var _yield$this$props$str,token,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();console.log(\"Handle submit called, with name: \"+this.state.value);_context.next=4;return this.props.stripe.createToken({name:this.state.value});case 4:_yield$this$props$str=_context.sent;token=_yield$this$props$str.token;if(!(token==null)){_context.next=10;break;}console.log(\"invalid token\");this.setState({status:FAILEDSTATE});return _context.abrupt(\"return\");case 10:_context.next=12;return fetch(\"/users/charge\",{method:\"POST\",headers:{\"Content-Type\":\"applicatin/json\"},body:JSON.stringify({token:id,customer_id:this.props.user,product_id:this.props.product_id,sell_price:this.props.price,rememberCard:this.state.remeber!==undefined,useExisting:this.state.useExisting})});case 12:response=_context.sent;if(response.ok){console.log(\"Purchase Complete!\");this.setState({status:SUCCESSSTATE});}else{this.setState({status:FAILEDSTATE});}//  document.getElementsByClassName('#modal').modal('hide');\ncase 14:case\"end\":return _context.stop();}}},_callee,this);}));function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}return handleSubmit;}()},{key:\"handleInputChange\",value:function handleInputChange(event){this.setState({value:event.target.value});}},{key:\"render\",value:function render(){var body=null;switch(this.state.status){case SUCCESSSTATE:body=this.renderSuccess();break;case FAILEDSTATE:body=this.renderFailure();break;default:body=this.renderCreditCardInformation();}return/*#__PURE__*/React.createElement(\"div\",null,body);}}]);return CreditCardForm;}(React.Component);export default function CreditCardInformation(props){if(!props.show){return null;}var CCFormWithStripe=injectStripe(CreditCardForm);return/*#__PURE__*/React.createElement(\"div\",null,props.separator?/*#__PURE__*/React.createElement(\"hr\",null):null,/*#__PURE__*/React.createElement(StripeProvider,{apiKey:\"pk_test_LwL4RUtinpP3PXzYirX2jNfR\"},/*#__PURE__*/React.createElement(Elements,null,/*#__PURE__*/React.createElement(CCFormWithStripe,{operation:props.operation}))));}","map":{"version":3,"sources":["C:/Users/whktj/Go_music/src/CreditCard.js"],"names":["React","injectStripe","StripeProvider","Elements","CardElement","INITIALSTATE","SUCCESSSTATE","FAILEDSTATE","CreditCardForm","props","handleSubmit","bind","handleInputChange","state","value","status","style","base","usersavedcard","remembercardcheck","operation","toggle","renderCreditCardInformation","event","preventDefault","console","log","stripe","createToken","name","token","setState","fetch","method","headers","body","JSON","stringify","id","customer_id","user","product_id","sell_price","price","rememberCard","remeber","undefined","useExisting","response","ok","target","renderSuccess","renderFailure","Component","CreditCardInformation","show","CCFormWithStripe","separator"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { injectStripe, StripeProvider, Elements, CardElement } from 'react-stripe-elements';\r\n\r\nconst INITIALSTATE = \"INITIAL\", SUCCESSSTATE = \"COMPLETE\", FAILEDSTATE = \"FAILED\";\r\n\r\nclass CreditCardForm extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.handleSubmit = this.handleSubmit.bind(this);\r\n        this.handleInputChange = this.handleInputChange.bind(this);\r\n        this.state = {\r\n            value: '',\r\n            status: INITIALSTATE\r\n        };\r\n    }\r\n\r\n    renderCreditCardInformation() {\r\n        const style = {\r\n            base: {\r\n                'fontSize': '20px',\r\n                'color': '#495057',\r\n                'fontFamily': 'apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,\"Helvetica Neue\",Arial,sans-serif'\r\n            }\r\n        };\r\n        const usersavedcard = <div>\r\n            <div className=\"form-row text-center\">\r\n                <button type=\"button\" className=\"btn  btn-outline-success text-center mx-auto\">Use saved card?</button>\r\n            </div>\r\n            <hr />\r\n        </div>\r\n\r\n        const remembercardcheck = <div className=\"form-row form-check text-center\">\r\n            <input className=\"form-check-input\" type=\"checkbox\" value=\"\" id=\"remembercardcheck\" />\r\n            <label className=\"form-check-label\" htmlFor=\"remembercardcheck\">\r\n                Remember Card?\r\n            </label>\r\n        </div>;\r\n        return (\r\n            <div>\r\n                {usersavedcard}\r\n                <h5 className=\"mb-4\">Payment Info</h5>\r\n                <form onSubmit={this.handleSubmit}>\r\n                    <div className=\"form-row\">\r\n                        <div className=\"col-lg-12 form-group\">\r\n                            <label htmlFor=\"cc-name\">Name On Card:</label>\r\n                            <input id=\"cc-name\" name='cc-name' className=\"form-control\" placeholder='Name on Card' onChange={this.handleInputChange} type='text' />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                        <div className=\"col-lg-12 form-group\">\r\n                            <label htmlFor=\"card\">Card Information:</label>\r\n                            <CardElement id=\"card\" className=\"form-control\" style={style} />\r\n                        </div>\r\n                    </div>\r\n                    {remembercardcheck}\r\n                    <hr className=\"mb-4\" />\r\n                    <button type=\"submit\" className=\"btn btn-success btn-large\" >{this.props.operation}</button>\r\n                </form>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    renderSuccess() {\r\n        return (\r\n            <div>\r\n                <h5 className=\"mb-4 text-success\">Credit card payment processed.....</h5>\r\n                <button type=\"submit\" className=\"btn btn-success btn-large\" onClick={() => { this.props.toggle() }}>Ok</button>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    renderFailure() {\r\n        return (\r\n            <div>\r\n                <h5 className=\"mb-4 text-danger\"> Credit card information invalid, try again or exit</h5>\r\n                {this.renderCreditCardInformation()}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    async handleSubmit(event) {\r\n        \r\n        event.preventDefault();\r\n        console.log(\"Handle submit called, with name: \" + this.state.value);\r\n\r\n        let { token } = await this.props.stripe.createToken({ name: this.state.value }); \r\n        if (token == null) {\r\n            console.log(\"invalid token\");\r\n            this.setState({ status: FAILEDSTATE });\r\n            return;\r\n        }\r\n\r\n        let response = await fetch(\"/users/charge\", {\r\n            method: \"POST\",\r\n            headers: { \"Content-Type\": \"applicatin/json\" },\r\n            body: JSON.stringify({\r\n                token: id,\r\n                customer_id : this.props.user,\r\n                product_id:this.props.product_id,\r\n                sell_price: this.props.price,\r\n                rememberCard: this.state.remeber !== undefined,\r\n                useExisting : this.state.useExisting\r\n            })\r\n        });\r\n        if (response.ok) {\r\n            console.log(\"Purchase Complete!\");\r\n            this.setState({ status: SUCCESSSTATE });\r\n        }else{\r\n            this.setState({ status: FAILEDSTATE });\r\n        }\r\n        //  document.getElementsByClassName('#modal').modal('hide');\r\n    }\r\n\r\n    handleInputChange(event) {\r\n        this.setState({\r\n            value: event.target.value\r\n        });\r\n    }\r\n\r\n    render() {\r\n\r\n        let body = null;\r\n        switch (this.state.status) {\r\n            case SUCCESSSTATE:\r\n                body = this.renderSuccess();\r\n                break;\r\n            case FAILEDSTATE:\r\n                body = this.renderFailure();\r\n                break;\r\n            default:\r\n                body = this.renderCreditCardInformation();\r\n        }\r\n\r\n        return (\r\n            <div>\r\n                {body}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default function CreditCardInformation(props) {\r\n    if (!props.show) {\r\n        return null;\r\n    }\r\n    const CCFormWithStripe = injectStripe(CreditCardForm);\r\n    return (\r\n        <div>\r\n            {props.separator ? <hr /> : null}\r\n            <StripeProvider apiKey=\"pk_test_LwL4RUtinpP3PXzYirX2jNfR\">\r\n                <Elements>\r\n                    <CCFormWithStripe operation={props.operation} />\r\n                </Elements>\r\n            </StripeProvider>\r\n        </div>\r\n    );\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}